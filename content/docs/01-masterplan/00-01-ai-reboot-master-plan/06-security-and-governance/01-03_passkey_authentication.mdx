---
title: パスキー認証
description: Passkey Authentication
icon: KeySquare
---

import { Mermaid } from "@/components/mdx/mermaid";

## パスワードなしの安全な世界へ：パスキー認証の全貌

### 🔑 エグゼクティブサマリー

パスキー認証（WebAuthn/FIDO2）は、従来のパスワードに代わる次世代の認証メカニズムです。生体認証や端末のセキュリティ機能を活用し、フィッシング耐性の高い認証を実現します。本文書では、パスキー認証の基本概念、動作原理、実装方法から具体的なユースケースまでを詳細に解説します。パスワードレスの安全な未来を実現するこの技術を、システム設計者やセキュリティ担当者が導入検討する際の指針となるようまとめています。

### 📋 本ドキュメントについて

#### 想定読者
- システム設計者・アーキテクト
- セキュリティエンジニア
- アプリケーション開発者
- ITセキュリティ管理者
- 認証システムの刷新を検討している意思決定者

#### 対象システム規模
- 中小規模から大規模エンタープライズシステム
- Webアプリケーション
- モバイルアプリケーション
- クラウドサービス

---

### 🔍 パスキー認証の基本概念

パスキー認証（WebAuthn/FIDO2）は、パスワードに依存しない新しい認証方式です。この技術は、以下の特徴を持っています。

- 公開鍵暗号方式を基盤とする強固な認証メカニズム
- 生体認証（指紋、顔認証など）や端末のセキュリティ機能との連携
- フィッシング攻撃に対する本質的な耐性
- シンプルかつ直感的なユーザー体験の提供
- クロスプラットフォーム対応の標準化された認証方式

パスキー認証は FIDO（Fast IDentity Online）アライアンスと W3C（World Wide Web Consortium）によって策定された WebAuthentication（WebAuthn）と FIDO2 の標準に基づいています。これらの標準は、ウェブやアプリケーションでの認証をより安全かつ使いやすくすることを目指しています。

---

### 🔐 パスキー認証の技術的基盤

#### 基本アーキテクチャ

パスキー認証は以下の主要コンポーネントで構成されています。

- **Relying Party（RP）**: 認証を要求するサービス（ウェブサイトやアプリケーション）
- **Authenticator**: 認証処理を実行するデバイス（スマートフォン、セキュリティキーなど）
- **Client**: ユーザーのブラウザやアプリケーション（WebAuthn APIを実装）
- **User Agent**: ブラウザなど、クライアント側で動作するソフトウェア

#### 動作の仕組み

パスキー認証の基本的な動作原理は以下の通りです。

1. **登録フェーズ**
   - ユーザーがサービスにアカウントを作成または既存アカウントにパスキーを追加
   - Relying Party が登録リクエストを作成
   - Authenticator が秘密鍵と公開鍵のペアを生成
   - 公開鍵と関連情報が Relying Party に送信され保存
   - 秘密鍵は Authenticator 内に安全に保管

2. **認証フェーズ**
   - ユーザーがサービスへのログイン時にパスキー認証を選択
   - Relying Party がチャレンジを生成
   - Authenticator が保存された秘密鍵でチャレンジに署名
   - 署名が Relying Party に送信され、保存された公開鍵で検証

<Mermaid chart={`
sequenceDiagram
    participant U as ユーザー
    participant C as クライアント(ブラウザ)
    participant RP as Relying Party(サービス)
    participant A as 認証器(Authenticator)

    %% 登録フロー
    rect rgb(135, 206, 250, 0.2)
    Note over U,RP: 登録フロー
    U->>RP: アカウント登録/パスキー追加
    RP->>C: 登録リクエスト作成
    C->>A: 登録リクエスト転送
    U->>A: 生体認証などで確認
    A->>A: 鍵ペア生成
    A->>C: 公開鍵・署名などを返送
    C->>RP: 認証情報を送信
    RP->>RP: 公開鍵を検証・保存
    RP->>C: 登録完了
    end

    %% 認証フロー
    rect rgb(255, 215, 0, 0.1)
    Note over U,RP: 認証フロー
    U->>RP: ログイン要求
    RP->>C: 認証チャレンジ送信
    C->>A: チャレンジ転送
    U->>A: 生体認証などで確認
    A->>A: 秘密鍵でチャレンジに署名
    A->>C: 署名を返送
    C->>RP: 署名を送信
    RP->>RP: 公開鍵で署名を検証
    RP->>C: 認証成功・アクセス許可
    end
`} />

*図1: パスキー認証の登録フローと認証フロー*

---

### 🛡️ セキュリティ特性と利点

パスキー認証は、従来のパスワードベースの認証と比較して数多くの優位性を持っています。

#### セキュリティ面での利点

- **フィッシング耐性**: 秘密鍵は認証器内に保存され、オリジン（ドメイン）と紐づけられるため、偽サイトでの認証が防止されます
- **認証情報漏洩リスクの低減**: サーバー側には公開鍵のみが保存され、ハッシュ化されたパスワードすら保存されないため、データ漏洩のリスクが大幅に軽減されます
- **中間者攻撃への耐性**: チャレンジ-レスポンス方式により、通信傍受による認証情報の再利用が困難です
- **マルウェア耐性**: 特にハードウェア認証器を使用する場合、マルウェアによる認証情報の窃取がほぼ不可能になります
- **ブルートフォース攻撃耐性**: パスワード入力がないため、総当たり攻撃が成立しません

#### ユーザー体験の向上

- **パスワード記憶・入力の不要化**: 複雑なパスワードを覚える必要がなく、入力ミスも発生しません
- **迅速な認証**: 生体認証と組み合わせることで、素早く簡単な認証体験を提供します
- **クロスデバイス認証**: スマートフォンで別端末のログインを認証するなど、柔軟な認証方法が可能です
- **パスワードリセットの削減**: パスワード忘れによるリセットプロセスが不要になり、運用コストが削減されます

---

### 📱 パスキー認証の主な形態

パスキー認証は様々な形態で実装できます。主な分類は以下の通りです。

#### 認証器の種類

1. **プラットフォーム認証器**
   - デバイスに組み込まれた認証メカニズム（指紋センサーや顔認証など）
   - 例: Touch ID、Face ID、Windows Hello

2. **クロスプラットフォーム認証器**
   - 外部の認証デバイス（セキュリティキーなど）
   - 例: YubiKey、Titan セキュリティキー
   - スマートフォンをセキュリティキーとして利用する方式も含む

3. **同期型パスキー**
   - クラウドサービスを通じてパスキーを複数デバイス間で同期
   - 例: Apple iCloud キーチェーン、Google パスワードマネージャー、Microsoft アカウント

#### 生体認証との連携

パスキー認証は多くの場合、以下の生体認証技術と組み合わせて使用されます。

- 指紋認証
- 顔認証
- 虹彩スキャン
- 音声認証

生体認証はユーザーの存在確認（User Presence）と本人確認（User Verification）に利用され、認証器内の秘密鍵へのアクセスを保護します。ただし、認証情報そのものは生体データではなく、暗号鍵である点が重要です。

---

### 💻 パスキー認証の実装方法

#### バックエンド実装の基本ステップ

1. **WebAuthn ライブラリの導入**
   - 言語・フレームワークに応じたライブラリを選択
   - Node.js: `@simplewebauthn/server`
   - Java: `webauthn4j`
   - Python: `py_webauthn`
   - PHP: `web-auth/webauthn-lib`

2. **登録エンドポイントの実装**
   - 登録オプションの生成
   - チャレンジの発行と一時保存
   - レスポンスの検証
   - 認証情報（公開鍵など）の保存

3. **認証エンドポイントの実装**
   - 認証オプションの生成
   - チャレンジの発行と一時保存
   - レスポンスの検証
   - ユーザー認証とセッション管理

#### フロントエンド実装の基本ステップ

1. **WebAuthn API の利用**
   - ブラウザの navigator.credentials API を使用
   - 登録処理: `navigator.credentials.create()`
   - 認証処理: `navigator.credentials.get()`

2. **UI/UX の設計**
   - パスキー認証の存在と利点をユーザーに説明
   - 登録・認証プロセスのガイダンス提供
   - フォールバック認証手段の提供

#### 考慮すべき実装ポイント

- **プログレッシブエンハンスメント**: WebAuthn をサポートしていないブラウザ向けのフォールバック手段の提供
- **リカバリーメカニズム**: デバイス紛失時の回復手段（バックアップパスキー、リカバリーコードなど）
- **複数認証器の管理**: ユーザーが複数のパスキーを登録・削除できる機能
- **トランスポートの指定**: USB、NFC、Bluetooth など、対応する接続方式の指定
- **認証器タイプの制限**: プラットフォーム認証器のみ、クロスプラットフォーム認証器のみなどの制限設定

---

### 🚀 パスキー認証の導入戦略

#### 導入ステップ

1. **現状評価**
   - 既存認証システムの分析
   - ユーザー層と対応デバイスの把握
   - セキュリティ要件の整理

2. **パイロット展開**
   - テストユーザーによる限定的な導入
   - フィードバックの収集と分析
   - 技術的課題の特定と対応

3. **段階的ロールアウト**
   - オプトイン方式での提供開始
   - パスワードとの併用期間の設定
   - ユーザー教育とサポート体制の整備

4. **完全導入**
   - パスワードレス認証への完全移行
   - 継続的なモニタリングと改善

#### 導入時の課題と対応策

- **ブラウザ・デバイス互換性**: サポート状況の確認と代替認証手段の提供
- **ユーザー教育**: パスキー利用のメリットと使用方法の説明
- **リカバリー手段**: デバイス紛失時の対応策の確立
- **組織ポリシーとの統合**: 既存の認証ポリシーとの整合性確保

---

### 📊 パスキー認証の実例と成功事例

パスキー認証はすでに多くの企業やサービスで採用されています。代表的な例として以下が挙げられます。

1. **大手テクノロジー企業**
   - Google アカウント
   - Microsoft アカウント
   - Apple ID

2. **金融サービス**
   - オンラインバンキング
   - 決済サービス
   - 暗号資産取引所

3. **エンタープライズシステム**
   - シングルサインオンサービス
   - 社内システムアクセス
   - クラウドサービス認証

これらの導入例から得られた主な教訓は以下の通りです。

- 段階的な導入が成功の鍵
- ユーザー教育の重要性
- バックアップ・リカバリー手段の必須化
- 技術サポート体制の整備

---

### 📈 今後の展望と課題

パスキー認証技術は急速に発展しており、今後さらなる進化が期待されます。

#### 将来の方向性

- **クロスプラットフォーム連携の強化**: 異なるプラットフォーム・エコシステム間でのパスキー共有・同期の改善
- **エンタープライズ向け機能の拡充**: 組織規模での管理機能、ポリシー設定、監査機能
- **IoT デバイスへの適用拡大**: スマートホーム、産業機器などへの認証適用
- **バイオメトリクス技術との深い統合**: 新たな生体認証技術とパスキーの組み合わせ

#### 残存課題

- **標準化の継続**: 相互運用性のさらなる向上
- **アクセシビリティの確保**: 様々な障害を持つユーザーへの対応
- **レガシーシステムとの統合**: 既存システムへの後付け対応の難しさ
- **リカバリーメカニズムの最適化**: セキュリティと利便性のバランス

---

### 🏁 まとめ

パスキー認証（WebAuthn/FIDO2）は、パスワードの弱点を克服し、より安全で使いやすい認証の世界への扉を開くものです。公開鍵暗号とデバイスセキュリティ、生体認証技術の組み合わせにより、フィッシングやパスワード漏洩などの脅威に対して本質的な耐性を持ちます。

今後のデジタル社会において、パスキー認証はセキュリティ強化と使いやすさの両立という長年の課題に対する有力な解決策となるでしょう。適切な導入戦略と段階的な移行計画に基づき、組織はパスワードレスの未来へと歩みを進めることができます。

特に IoT やエッジコンピューティングが進む中、従来のパスワード管理の限界を超えた認証メカニズムとして、パスキー認証の重要性はますます高まると予想されます。

---

### 📚 用語解説

| 用語 | 説明 |
|------|------|
| WebAuthn | Web Authentication の略。W3C が策定した Web 認証 API の標準規格。 |
| FIDO2 | Fast IDentity Online の第 2 版規格。WebAuthn と CTAP プロトコルから構成される。 |
| CTAP | Client to Authenticator Protocol の略。クライアントと認証器間の通信プロトコル。 |
| Relying Party (RP) | 認証を要求するサービス側（ウェブサイトやアプリケーション）。 |
| Authenticator | 認証処理を実行するデバイスやソフトウェア。 |
| 認証アサーション | 認証時に Authenticator が生成する、チャレンジへの署名を含むデータ構造。 |
| 公開鍵暗号方式 | 公開鍵と秘密鍵のペアを使用する暗号化方式。 |
| User Presence (UP) | ユーザーの存在確認。物理ボタン押下などで確認。 |
| User Verification (UV) | ユーザー本人確認。生体認証やPINなどで実施。 |
| Attestation | 認証器の信頼性を証明するプロセス。 |
| Resident Key | 認証器内に保存され、ユーザー ID 情報も含む鍵。パスキーとも呼ばれる。 |
